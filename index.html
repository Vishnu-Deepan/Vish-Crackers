<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Vish Crackers Enquiry – enquire about firecrackers and get in touch with us. Please note, online sales are not permitted." />
  <meta name="robots" content="index, follow" />
  <title>Vish Crackers Enquiry</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <header>
    <div class="header-left">
        <h1>Vish Crackers</h1>
        <h3>Contact : Vishnu - 9994376845</h3>
    </div>
    <div class="header-right">
        <!-- Button to download the Price List PDF -->
        <a href="https://drive.google.com/file/d/12AXLe4ARRVtOLPQC8XL8B_Y1FkZFkKMv/view?usp=sharing" target="_blank" id="download-pdf-btn" class="download-btn">Download Price List</a>
    </div>
    <p class="note">
        ⚠️ Online sale of firecrackers is <strong>not permitted</strong> (2018 Supreme Court Order).
        You can enquire about products, and we’ll contact you within 24 hrs.
    </p>
  </header>

  <main id="product-container"></main>

  <div id="bottom-bar">
    <button id="view-cart-btn" disabled aria-label="View Cart & Send Enquiry">View Cart &amp; Send Enquiry</button>
  </div>

  <!-- Cart Summary Modal -->
  <div id="cart-modal" class="modal hidden" aria-hidden="true">
    <div class="modal-content">
      <h2>Your Cart Summary</h2>
      <div id="cart-summary"></div>
      <div class="modal-actions">
        <button id="close-cart-btn" aria-label="Close Cart">Close</button>
        <button id="confirm-enquiry-btn" class="primary" aria-label="Send Enquiry">Send Enquiry</button>
      </div>
    </div>
  </div>

  <!-- Address Modal -->
  <div id="address-modal" class="modal hidden">
    <div class="modal-content">
      <h2>Enter Your Address</h2>
      <form id="address-form">
        <label>
          Name:<br />
          <input type="text" id="name" name="name" required style="width: 100%;" />
        </label><br /><br />
        <label>
          Phone:<br />
          <input type="text" id="phone" name="phone" required style="width: 100%;" />
        </label><br /><br />
        <label>
          Address:<br />
          <textarea id="address" name="address" required rows="3" style="width: 100%;"></textarea>
        </label><br /><br />
        <label>
          City:<br />
          <input type="text" id="city" name="city" required style="width: 100%;" />
        </label><br /><br />
        <label>
          State:<br />
          <input type="text" id="state" name="state" required style="width: 100%;" />
        </label><br /><br />
        <label>
          Pincode:<br />
          <input type="text" id="pincode" name="pincode" required pattern="\d{5,6}" title="Enter valid pincode" style="width: 100%;" />
        </label><br /><br />
        <div class="modal-actions">
          <button type="button" id="cancel-address-btn">Cancel</button>
          <button type="submit" class="primary">Save Address</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Hidden Google Form (Not visible to users) -->
  <form id="google-form" 
        action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSe0ZaXWHcfR69l2T67ndBb8l3Qy1Ahf1N7NMD706vyZPJ7l3g/formResponse" 
        method="POST" 
        style="display: none;" 
        onsubmit="return false;">  <!-- Prevent default form submission -->
      <input type="text" name="entry.452695221" id="name-input" />
      <input type="text" name="entry.1846109305" id="phone-input" />
      <input type="text" name="entry.944025910" id="address-input" />
      <input type="text" name="entry.2048288889" id="products-input" />
      <input type="text" name="entry.174664773" id="quantities-input" />
      <input type="text" name="entry.1888919222" id="prices-input" />
      <input type="text" name="entry.273267764" id="total-input" />

      <input type="submit" id="submit-form" />
  </form>

  <script src="products.js"></script>
  <script src="script.js"></script>

  <script>
    // Collect data from the user and submit it to Google Forms
    function collectAndSubmitData() {
        // Gather form data from the webpage
        const name = document.getElementById('name').value;
        const phone = document.getElementById('phone').value;
        const address = document.getElementById('address').value;
        const products = Object.keys(cart).map(item => `${item} (${cart[item].quantity})`).join(', ');
        const quantities = Object.keys(cart).map(item => cart[item].quantity).join(', ');
        const prices = Object.keys(cart).map(item => cart[item].price).join(', ');
        const total = Object.keys(cart).reduce((sum, item) => sum + cart[item].price * cart[item].quantity, 0);

        // Check if the required fields are filled out
        if (!name || !phone || !address || !products || !quantities || !prices || !total) {
            alert("Please ensure all fields are filled out before submitting.");
            return;
        }

        // Populate the hidden form fields with the gathered data
        document.getElementById('name-input').value = name;
        document.getElementById('phone-input').value =  phone;
        document.getElementById('address-input').value = address;
        document.getElementById('products-input').value = products;
        document.getElementById('quantities-input').value = quantities;
        document.getElementById('prices-input').value = prices;
        document.getElementById('total-input').value = total;

        // Submit the hidden Google Form using JavaScript without triggering the form's confirmation page
        const googleForm = document.getElementById('google-form');
        
        // Submit the form in the background
        googleForm.submit();

        // Prevent the page from redirecting and show the success message
        alert("Enquiry submitted successfully. We will contact you soon!");
    }

    // Attach the event listener to the "Send Enquiry" button
    document.getElementById("confirm-enquiry-btn").addEventListener("click", collectAndSubmitData);
  </script>

</body>
</html>
